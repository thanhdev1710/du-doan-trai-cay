============================================================
🚀 STARTING TRAINING PROCESS 🚀
============================================================
Device: cuda
Epochs: 20, Batch Size: 32
Learning Rate: 0.0001, Weight Decay: 1e-05
Early Stopping Patience: 4
LR Scheduler Patience: 2
Model will be saved to: mobilenetv2_best_v3.pth
Training samples: 35876, Validation samples: 16162
Number of classes: 6
============================================================

📅 Epoch 1/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 1 Summary (took 280.30s):
   Train Loss: 0.2618 | Train Acc: 0.9143
   Val   Loss: 0.1424 | Val   Acc: 0.9529
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.1424)
============================================================
📅 Epoch 2/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 2 Summary (took 285.60s):
   Train Loss: 0.1615 | Train Acc: 0.9468
   Val   Loss: 0.1065 | Val   Acc: 0.9628
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.1065)
============================================================
📅 Epoch 3/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 3 Summary (took 276.03s):
   Train Loss: 0.1387 | Train Acc: 0.9541
   Val   Loss: 0.0803 | Val   Acc: 0.9707
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0803)
============================================================
📅 Epoch 4/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 4 Summary (took 276.12s):
   Train Loss: 0.1196 | Train Acc: 0.9606
   Val   Loss: 0.0670 | Val   Acc: 0.9788
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0670)
============================================================
📅 Epoch 5/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 5 Summary (took 281.57s):
   Train Loss: 0.1055 | Train Acc: 0.9650
   Val   Loss: 0.0573 | Val   Acc: 0.9815
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0573)
============================================================
📅 Epoch 6/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 6 Summary (took 275.23s):
   Train Loss: 0.0993 | Train Acc: 0.9674
   Val   Loss: 0.0521 | Val   Acc: 0.9823
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0521)
============================================================
📅 Epoch 7/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 7 Summary (took 275.48s):
   Train Loss: 0.0959 | Train Acc: 0.9675
   Val   Loss: 0.0645 | Val   Acc: 0.9775
   📉 Val loss did not improve for 1 epoch(s). Best: 0.0521
============================================================
📅 Epoch 8/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 8 Summary (took 275.12s):
   Train Loss: 0.0894 | Train Acc: 0.9695
   Val   Loss: 0.0501 | Val   Acc: 0.9845
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0501)
============================================================
📅 Epoch 9/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 9 Summary (took 274.68s):
   Train Loss: 0.0784 | Train Acc: 0.9741
   Val   Loss: 0.0462 | Val   Acc: 0.9844
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0462)
============================================================
📅 Epoch 10/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 10 Summary (took 276.46s):
   Train Loss: 0.0780 | Train Acc: 0.9744
   Val   Loss: 0.0425 | Val   Acc: 0.9867
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0425)
============================================================
📅 Epoch 11/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 11 Summary (took 275.60s):
   Train Loss: 0.0685 | Train Acc: 0.9775
   Val   Loss: 0.0313 | Val   Acc: 0.9895
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0313)
============================================================
📅 Epoch 12/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 12 Summary (took 274.64s):
   Train Loss: 0.0691 | Train Acc: 0.9767
   Val   Loss: 0.0320 | Val   Acc: 0.9892
   📉 Val loss did not improve for 1 epoch(s). Best: 0.0313
============================================================
📅 Epoch 13/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 13 Summary (took 284.45s):
   Train Loss: 0.0640 | Train Acc: 0.9784
   Val   Loss: 0.0303 | Val   Acc: 0.9897
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0303)
============================================================
📅 Epoch 14/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 14 Summary (took 274.79s):
   Train Loss: 0.0659 | Train Acc: 0.9780
   Val   Loss: 0.0330 | Val   Acc: 0.9903
   📉 Val loss did not improve for 1 epoch(s). Best: 0.0303
============================================================
📅 Epoch 15/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 15 Summary (took 273.66s):
   Train Loss: 0.0540 | Train Acc: 0.9822
   Val   Loss: 0.0344 | Val   Acc: 0.9892
   📉 Val loss did not improve for 2 epoch(s). Best: 0.0303
============================================================
📅 Epoch 16/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 16 Summary (took 273.64s):
   Train Loss: 0.0583 | Train Acc: 0.9806
   Val   Loss: 0.0200 | Val   Acc: 0.9939
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0200)
============================================================
📅 Epoch 17/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 17 Summary (took 273.84s):
   Train Loss: 0.0547 | Train Acc: 0.9819
   Val   Loss: 0.0356 | Val   Acc: 0.9883
   📉 Val loss did not improve for 1 epoch(s). Best: 0.0200
============================================================
📅 Epoch 18/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 18 Summary (took 273.97s):
   Train Loss: 0.0558 | Train Acc: 0.9820
   Val   Loss: 0.0261 | Val   Acc: 0.9923
   📉 Val loss did not improve for 2 epoch(s). Best: 0.0200
============================================================
📅 Epoch 19/20 | Current LR: 1.0e-04
------------------------------------------------------------
✅ Epoch 19 Summary (took 274.61s):
   Train Loss: 0.0474 | Train Acc: 0.9845
   Val   Loss: 0.0233 | Val   Acc: 0.9926
   📉 Val loss did not improve for 3 epoch(s). Best: 0.0200
============================================================
📅 Epoch 20/20 | Current LR: 5.0e-05
------------------------------------------------------------
✅ Epoch 20 Summary (took 274.16s):
   Train Loss: 0.0304 | Train Acc: 0.9902
   Val   Loss: 0.0134 | Val   Acc: 0.9956
   💾 Best model saved to mobilenetv2_best_v3.pth (Val Loss: 0.0134)
============================================================

🎉 TRAINING COMPLETE! 🎉
Total training time: 92m 11s

🔄 Loading best model from mobilenetv2_best_v3.pth for final evaluation on test set...

============================================================
📊 EVALUATING ON TEST SET 📊
============================================================
   Test Loss: 0.0147 | Test Accuracy: 0.9958

Classification Report:

              precision    recall  f1-score   support

       apple       1.00      1.00      1.00      3513
      banana       0.99      0.99      0.99       957
       grape       0.99      0.98      0.99       708
       mango       0.99      0.99      0.99       889
  strawberry       0.99      1.00      1.00       904
     unknown       1.00      1.00      1.00      2499

    accuracy                           1.00      9470
   macro avg       0.99      0.99      0.99      9470
weighted avg       1.00      1.00      1.00      9470


Weighted F1-score: 0.9958
============================================================

📈 Plotting Training History...
📊 Training plots saved to 'mobilenetv2_training_plot_v3.png'

🏁 Script Finished 🏁